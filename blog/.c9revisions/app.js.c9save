{"ts":1347071046993,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\n/**\n * Module dependencies.\n */\n\nvar express = require('express')\n  , routes = require('./routes')\n  , user = require('./routes/user')\n  , http = require('http')\n  , path = require('path');\n\nvar app = express();\n//var ArticleProvider = require('./articleprovider-memory').ArticleProvider;\nvar ArticleProvider = require('./articleprovider-mongodb').ArticleProvider;\n\napp.configure(function(){\n  app.set('port', process.env.PORT || 3000);\n  app.set('views', __dirname + '/views');\n  app.set('view engine', 'jade');\n  app.use(express.favicon());\n  app.use(express.logger('dev'));\n  app.use(express.bodyParser());\n  app.use(express.methodOverride());\n  app.use(app.router);\n  app.use(require('stylus').middleware(__dirname + '/public'));\n  app.use(express.static(path.join(__dirname, 'public')));\n});\n\napp.configure('development', function(){\n  app.use(express.errorHandler());\n});\n\n//var articleProvider= new ArticleProvider();\nvar articleProvider = new ArticleProvider('localhost', 27017);\n\n//app.get('/', routes.index);\n//app.get('/users', user.list);\n\napp.get('/', function(req, res){\n\tarticleProvider.findAll(function(error, docs){\n\t\tres.render('index', { title: 'Blog', articles:docs });\n\t});\n});\n\napp.get('/blog/new', function(req, res) {\n    res.render('blog_new.jade', {title: 'New Post'});\n});\n\napp.post('/blog/new', function(req, res){\n    articleProvider.save({\n        title: req.param('title'),\n        body: req.param('body')\n    }, function( error, docs) {\n        res.redirect('/')\n    });\n});\n\napp.get('/blog/:id', function(req, res) {\n    articleProvider.findById(req.params.id, function(error, article) {\n        res.render('blog_show.jade',{title: article.title,article:article});\n    });\n});\n\napp.post('/blog/addComment', function(req, res) {\n    articleProvider.addCommentToArticle(req.param('_id'), {\n        person: req.param('person'),\n        comment: req.param('comment'),\n        created_at: new Date()\n       } , function( error, docs) {\n           res.redirect('/blog/' + req.param('_id'))\n       });\n});\n\nhttp.createServer(app).listen(app.get('port'), function(){\n  //console.log(\"Express server listening on port \" + app.get('port'));\n  console.log(\"Express server listening on port %d in %s mode\", app.get('port'), app.settings.env);\n});\n"]],"start1":0,"start2":0,"length1":0,"length2":2269}]],"length":2269}
{"contributors":[],"silentsave":false,"ts":1347071071691,"patch":[[{"diffs":[[0,"xpress')"],[-1,"\n  ,"],[1,";\nvar"],[0," routes "]],"start1":58,"start2":58,"length1":20,"length2":21},{"diffs":[[0,"routes')"],[-1,"\n  ,"],[1,";\nvar"],[0," user = "]],"start1":92,"start2":92,"length1":20,"length2":21},{"diffs":[[0,"s/user')"],[-1,"\n  ,"],[1,";\nvar"],[0," http = "]],"start1":129,"start2":129,"length1":20,"length2":21},{"diffs":[[0,"tp')"],[-1,"\n  ,"],[1,";\nvar"],[0," pat"]],"start1":161,"start2":161,"length1":12,"length2":13}]],"length":2273,"saved":false}
{"ts":1347071134295,"patch":[[{"diffs":[[0,"es.\n */\n"],[1," "],[0,"\nvar exp"]],"start1":25,"start2":25,"length1":16,"length2":17},{"diffs":[[0,"'express');\n"],[1,"//"],[0,"var routes ="]],"start1":57,"start2":57,"length1":24,"length2":26},{"diffs":[[0,"./routes');\n"],[1,"//"],[0,"var user = r"]],"start1":93,"start2":93,"length1":24,"length2":26}]],"length":2278,"saved":false}
{"ts":1347071380023,"patch":[[{"diffs":[[0,");\n    });\n});\n\n"],[1,"app.get('blog/edit/:id', function(req,res){\n    articleProvider.findById(req.params.id, function(error, article){\n        res.render('blog_edit.jade',{article:article});    \n    });    \n});\n\n"],[0,"app.post('/blog/"]],"start1":1705,"start2":1705,"length1":32,"length2":223}]],"length":2469,"saved":false}
